<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compute likelihood profiles for a fitted model — profile.glmmTMB • glmmTMB</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Compute likelihood profiles for a fitted model — profile.glmmTMB" />
<meta property="og:description" content="Compute likelihood profiles for a fitted model" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-standard navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">glmmTMB</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/glmmTMB.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/covstruct.html">Covariance structures with glmmTMB</a>
    </li>
    <li>
      <a href="../articles/covstruct.html">Covariance structures with glmmTMB</a>
    </li>
    <li>
      <a href="../articles/mcmc.html">post-hoc MCMC with glmmTMB</a>
    </li>
    <li>
      <a href="../articles/mcmc.html">post-hoc MCMC with glmmTMB</a>
    </li>
    <li>
      <a href="../articles/miscEx.html">Miscellaneous examples</a>
    </li>
    <li>
      <a href="../articles/miscEx.html">Miscellaneous examples</a>
    </li>
    <li>
      <a href="../articles/model_evaluation.html">model evaluation</a>
    </li>
    <li>
      <a href="../articles/parallel.html">Parallel optimization using glmmTMB</a>
    </li>
    <li>
      <a href="../articles/sim.html">Simulate from a fitted glmmTMB model</a>
    </li>
    <li>
      <a href="../articles/sim.html">Simulate from a fitted glmmTMB model</a>
    </li>
    <li>
      <a href="../articles/troubleshooting.html">Troubleshooting with glmmTMB</a>
    </li>
    <li>
      <a href="../articles/troubleshooting.html">Troubleshooting with glmmTMB</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../repos/index.html">
    <span class="fa fa-database fa-lg"></span>
     
    binary packages
  </a>
</li>
<li>
  <a href="https://github.com/glmmTMB/glmmTMB">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute likelihood profiles for a fitted model</h1>
    <small class="dont-index">Source: <a href='https://github.com/glmmTMB/glmmTMB/blob/master/R/profile.R'><code>R/profile.R</code></a></small>
    <div class="hidden name"><code>profile.glmmTMB.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute likelihood profiles for a fitted model</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for glmmTMB</span>
<span class='fu'><a href='https://rdrr.io/r/stats/profile.html'>profile</a></span><span class='op'>(</span>
  <span class='va'>fitted</span>,
  parm <span class='op'>=</span> <span class='cn'>NULL</span>,
  level_max <span class='op'>=</span> <span class='fl'>0.99</span>,
  npts <span class='op'>=</span> <span class='fl'>8</span>,
  stepfac <span class='op'>=</span> <span class='fl'>1</span><span class='op'>/</span><span class='fl'>4</span>,
  stderr <span class='op'>=</span> <span class='cn'>NULL</span>,
  trace <span class='op'>=</span> <span class='cn'>FALSE</span>,
  parallel <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"no"</span>, <span class='st'>"multicore"</span>, <span class='st'>"snow"</span><span class='op'>)</span>,
  ncpus <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"profile.ncpus"</span>, <span class='fl'>1L</span><span class='op'>)</span>,
  cl <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S3 method for profile.glmmTMB</span>
<span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>object</span>, parm <span class='op'>=</span> <span class='cn'>NULL</span>, level <span class='op'>=</span> <span class='fl'>0.95</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>fitted</th>
      <td><p>a fitted <code>glmmTMB</code> object</p></td>
    </tr>
    <tr>
      <th>parm</th>
      <td><p>which parameters to profile, specified</p><ul>
<li><p>by index (position)</p></li>
<li><p>by name (matching the row/column names of <code><a href='https://rdrr.io/r/stats/vcov.html'>vcov(object,full=TRUE)</a></code>)</p></li>
<li><p>as <code>"theta_"</code> (random-effects variance-covariance parameters) or <code>"beta_"</code> (conditional and zero-inflation parameters)</p></li>
</ul></td>
    </tr>
    <tr>
      <th>level_max</th>
      <td><p>maximum confidence interval target for profile</p></td>
    </tr>
    <tr>
      <th>npts</th>
      <td><p>target number of points in (each half of) the profile (<em>approximate</em>)</p></td>
    </tr>
    <tr>
      <th>stepfac</th>
      <td><p>initial step factor (fraction of estimated standard deviation)</p></td>
    </tr>
    <tr>
      <th>stderr</th>
      <td><p>standard errors to use as a scaling factor when picking step
sizes to compute the profile; by default (if <code>stderr</code> is
<code>NULL</code>, or <code>NA</code> for a particular element),
uses the estimated (Wald) standard errors of the parameters</p></td>
    </tr>
    <tr>
      <th>trace</th>
      <td><p>print tracing information? If <code>trace=FALSE</code> or 0,
no tracing; if <code>trace=1</code>, print names of parameters currently
being profiled; if <code>trace&gt;1</code>, turn on tracing for the
underlying <code>tmbprofile</code> function</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>method (if any) for parallel computation</p></td>
    </tr>
    <tr>
      <th>ncpus</th>
      <td><p>number of CPUs/cores to use for parallel computation</p></td>
    </tr>
    <tr>
      <th>cl</th>
      <td><p>cluster to use for parallel computation</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments passed to <code>tmbprofile</code></p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>a fitted profile (<code>profile.glmmTMB</code>) object</p></td>
    </tr>
    <tr>
      <th>level</th>
      <td><p>confidence level</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>profile.glmmTMB</code>, which is also a
data frame, with columns <code>.par</code> (parameter being profiled),
<code>.focal</code> (value of focal parameter), value (negative log-likelihood).</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Fits natural splines separately to the points from each half of the profile for each
specified parameter (i.e., values above and below the MLE), then finds the inverse functions
to estimate the endpoints of the confidence interval</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>m1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='glmmTMB.html'>glmmTMB</a></span><span class='op'>(</span><span class='va'>count</span><span class='op'>~</span> <span class='va'>mined</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span><span class='op'>|</span><span class='va'>site</span><span class='op'>)</span>,
       zi<span class='op'>=</span><span class='op'>~</span><span class='va'>mined</span>, family<span class='op'>=</span><span class='va'>poisson</span>, data<span class='op'>=</span><span class='va'>Salamanders</span><span class='op'>)</span>
<span class='va'>salamander_prof1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/profile.html'>profile</a></span><span class='op'>(</span><span class='va'>m1</span>, parallel<span class='op'>=</span><span class='st'>"multicore"</span>,
                            ncpus<span class='op'>=</span><span class='fl'>2</span>, trace<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='co'>## testing</span>
<span class='va'>salamander_prof1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/profile.html'>profile</a></span><span class='op'>(</span><span class='va'>m1</span>, trace<span class='op'>=</span><span class='fl'>1</span>,parm<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>salamander_prof1M</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/profile.html'>profile</a></span><span class='op'>(</span><span class='va'>m1</span>, trace<span class='op'>=</span><span class='fl'>1</span>,parm<span class='op'>=</span><span class='fl'>1</span>, npts <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span>
<span class='va'>salamander_prof2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/profile.html'>profile</a></span><span class='op'>(</span><span class='va'>m1</span>, parm<span class='op'>=</span><span class='st'>"theta_"</span><span class='op'>)</span>

<span class='op'>}</span>
<span class='va'>salamander_prof1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"example_files"</span>,<span class='st'>"salamander_prof1.rds"</span>,package<span class='op'>=</span><span class='st'>"glmmTMB"</span><span class='op'>)</span><span class='op'>)</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='st'><a href='https://ggplot2.tidyverse.org'>"ggplot2"</a></span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>salamander_prof1</span>,<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>.focal</span>,<span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>value</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span>
        <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_wrap.html'>facet_wrap</a></span><span class='op'>(</span><span class='op'>~</span><span class='va'>.par</span>,scale<span class='op'>=</span><span class='st'>"free_x"</span><span class='op'>)</span><span class='op'>+</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept<span class='op'>=</span><span class='fl'>1.96</span>,linetype<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
<span class='op'>}</span>
</div><div class='output co'>#&gt; <span class='message'>Loading required package: ggplot2</span></div><div class='img'><img src='profile.glmmTMB-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='va'>salamander_prof1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"example_files"</span>,<span class='st'>"salamander_prof1.rds"</span>,package<span class='op'>=</span><span class='st'>"glmmTMB"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>salamander_prof1</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                     2.5 %     97.5 %
#&gt; (Intercept)    -0.4686460  0.4805030
#&gt; minedno         0.6449938  1.7417972
#&gt; zi~(Intercept)  0.6088771  1.5648495
#&gt; zi~minedno     -2.2239195 -1.1665205
#&gt; theta_1|site.1 -1.9452621 -0.5786442</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>salamander_prof1</span>,level<span class='op'>=</span><span class='fl'>0.99</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                     0.5 %     99.5 %
#&gt; (Intercept)    -0.6830922  0.5865649
#&gt; minedno         0.6015779  1.9853898
#&gt; zi~(Intercept)  0.4108581  1.6910201
#&gt; zi~minedno     -2.3713049 -0.9600516
#&gt; theta_1|site.1 -2.1810585 -0.3697326</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Mollie Brooks, Ben Bolker, Kasper Kristensen, Martin Maechler, Arni Magnusson, Hans Skaug, Anders Nielsen, Casper Berg, Koen van Bentham.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1 and <a href="https://github.com/HenrikBengtsson/pkgdown.extras/">pkgdown.extras</a> 0.0.0.9003.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


